---
title: "id_table"
output: html_document
---


```{r}
require(tidyverse)
require(tidytable)
require(WikidataQueryServiceR)
library(targets)

tar_option_set(
  packages = c("paws", "tidyverse", "arrow"),
  repository = "aws", 
  repository_meta = "aws",
  error = "null",
  resources = tar_resources(
    aws = tar_resources_aws(
      endpoint = Sys.getenv("S3_ENDPOINT"),
      bucket = "scoavoux",
      prefix = "music_artists"
    )
  )
)

tar_source("R")

s3 <- initialize_s3()
```


## Import all IDs

### CONTACT ID - 776K unique
```{r}
f <- s3$get_object(Bucket = "scoavoux", 
                   Key = "senscritique/contacts.csv")
co <- f$Body %>% rawToChar() %>% fread() %>% distinct()
rm(f)

f <- s3$get_object(Bucket = "scoavoux", 
                   Key = "senscritique/contacts_tracks.csv")
co_tr <- f$Body %>% rawToChar() %>% fread()
rm(f)
co <- bind_rows(co, co_tr) %>% distinct()
```


### MBZ-WIKIDATA - 776K unique
```{r}
mbz_wikidata <- s3$get_object(Bucket = "scoavoux", 
                   Key = "musicbrainz/mbid_wikidataid_pair.csv")
mbz_wikidata <- mbz_wikidata$Body %>% rawToChar() %>% read_csv()

length(unique(mbz_wikidata$mbid)) # 200 duplicates
length(unique(mbz_wikidata$wikidata_id)) # 3K duplicates
```


```{r}

```



















